# test_vbaProjectCompiler.py

import pytest
from vbaProjectCompiler.main import *

def test_directory():

    dir = Directory()
    dir.name = "Root Entry"
    assert dir.nameSize() == 22

    dir.type = 5
    dir.subDirectoryId = 8
    dir.modified = '\xc0\x23\xb8\xc2\x33\x24\xd9\x01'
    dir.sector = 3
    dir.size = 6528

    expected = b'\x52\x00\x6F\x00\x6F\x00\x74\x00\x20\x00\x45\x00\x6E\x00\x74\x00\x72\x00\x79\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x16\x00\x05\x00\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xC0\x23\xB8\xC2\x33\x24\xD9\x01\x03\x00\x00\x00\x80\x19\x00\x00\x00\x00\x00\x00
    result = dir.writeDirectory()
    assert result == expected
    
